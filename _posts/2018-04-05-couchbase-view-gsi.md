---
title: View (Local Indexes) vs GSI (Global Indexes)
date: 2018-04-05
categories: couchbase
---

#### 비교
- 로컬인덱스 : 노드에서 로컬 데이터를 고속으로 인덱싱, 인덱스에 복잡한 처리 논리가 있거나 분석을 위해 다양한 모양의 데이터를 사전 집계하는 경우 유용. 노드가 늘어나면 쿼리 응답시간 지연이 일어남.
- 글로벌인덱스 : 네트워크간 처리가 적으면서 대화식 쿼리를 신속하게 실행할 수 있는 기능 제공. 글로벌 인덱스 유지, 관리에는 네트워크 IO가 필요. 

#### 동작방식 요약
- 로컬인덱스 : 쿼리 실행하면 모든 노드에 쿼리를 뿌림, 각 노드에서 실행한 결과를 수집, 수집한 결과 재집계
- 글로벌인덱스 : 쿼리를 니켈 서비스노드에서 실행하고, 인덱스 서비스 노드에서 스캔함.


니켈이나 풀 텍스트, view 를 이용한 질의를 위해서 couchbase server에 네 가지 유형의 index가 있으며, 이러한 인덱스는 서로 다른 서비스에서 처리됨.

##### 네가지 유형의 index

- Global Secondary Index : 각 노드의 로컬 데이터에 대한 인덱스만 하는 뷰 인덱스와 달리, 글로벌 보조 인덱스는 클러스터 전체에 걸쳐 독립적인 집합에 저장되어진다. 글로벌 보조 인덱스는 인덱스 노드에 상주하여 전체 버킷의 데이터를 인덱싱한다. 인덱스 서비스는 글로벌 보조 인덱스를 관리할 책임이 있다.
- MapReduceViews (View) : 카우치베이스 버킷의 도큐먼트에 정의된 자바스크립트 맵, 리듀스 펑션을 사용해 인덱스를 빌딩한다. View는 View Api나 N1QL 을 통해 직접 접근될 수 있다. (N1QL 은 오직 create index … using view 를 이용해 생성된 뷰만 활용할 수 있다.) 뷰는 점진적으로 구축되어 마지막 인덱스 이후 변경된 문서만 다시 인덱싱한다. couchbase server는 빠른 검색을 위해 view result를 미리 계산하고 저장한다. 데이터 서비스는 MapReduce 뷰를 관리할 책임이 있다.
- Spatial View : 이런 것도 있구나….. MapReduce View와 Spatial View의 가장 큰 차이점은 Spatial View는 map reduce의 두개의 function 대신 spatial function이라 불리는 하나의 funtion이 있음. 이것도 MapReduce view와 마찬가지로 데이터 서비스에서 처리함.
- Full Text Index : 전체 텍스트 색인 (FTS)을 사용하면 응용 프로그램에서 FTS API를 사용하여 데이터에 대해 빠른 키워드 검색 (Google 유사 검색)을 수행 할 수 있습니다. 전체 텍스트 인덱스는 글로벌 보조 인덱스와 마찬가지로 글로벌 인덱스. 각 데이터 노드에 로컬 인 데이터의 하위 집합 만 인덱싱하는 뷰 인덱스와 달리 전체 텍스트 인덱스는 클러스터 전체의 노드 집합에 독립적으로 분산됨. 전체 텍스트 인덱스는 하나 이상의 버킷 데이터를 인덱싱 할 수 있다. 전체 텍스트 서비스는 FTS 인덱스를 처리한다.
